---
title: "R Notebook"
output:
  html_notebook: default
  pdf_document: default
---
```{r install and load packages}
source("https://bioconductor.org/biocLite.R")

if(!require("pacman", character.only = TRUE)) install.packages("pacman")
pacman::p_load(viper,data.table,dplyr)

```

```{r load fly data}
#setwd("C:/Users/bwillia/Desktop/Fly_ARACNe/DGRP_ARACNe")

# regulon
load(file = "Fly_Female-tf_regulon.rda")


# expression assay data
dsetF <- fread(file ="dgrp.array.exp.female.csv")
dsetM <- fread(file ="dgrp.array.exp.male.csv")
```

```{r generate expressionsets from }
# create ExpressionSet object
females.matrix <- as.matrix(dsetF, rownames = "gene")
females.eset <- ExpressionSet(assayData= females.matrix)

males.matrix <- as.matrix(dsetM, rownames = "gene")
males.eset <- ExpressionSet(assayData= males.matrix)

```


```{r run viper}
females.viper <- viper(females.eset, regulon = regul, cores = detectCores())
```

```{r exploratory clustering}
females_vipersimilarity <- viperSimilarity(exprs(females.viper))

heatmap(as.matrix(as.dist(females_vipersimilarity)), Rowv = as.dendrogram(hclust(as.dist(females_vipersimilarity), method = "average")), symm = T) #need phenodata to look at drug effects!
```

